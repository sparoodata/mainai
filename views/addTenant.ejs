<html>
<head>
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <script>
        async function fetchUnits(propertyId) {
            const response = await fetch('/getUnits/' + propertyId);
            const units = await response.json();
            const unitDropdown = document.getElementById('unitAssigned');
            unitDropdown.innerHTML = '';
            units.forEach(unit => {
                const option = document.createElement('option');
                option.value = unit._id;
                option.text = unit.unitNumber;
                unitDropdown.appendChild(option);
            });
        }
    </script>
</head>
<body>
    <div class="container">
        <h2>Add a New Tenant</h2>
        <form action="/addtenant/<%= id %>" method="POST" enctype="multipart/form-data">
            <label for="name">Tenant Name:</label>
            <input type="text" id="name" name="name" required><br><br>

            <label for="phoneNumber">Phone Number:</label>
            <input type="text" id="phoneNumber" name="phoneNumber" required><br><br>

            <label for="propertyName">Property:</label>
            <select id="propertyName" name="propertyName" required onchange="fetchUnits(this.value)">
                <% properties.forEach(function(property) { %>
                    <option value="<%= property._id %>"><%= property.name %></option>
                <% }) %>
            </select><br><br>

            <label for="unitAssigned">Unit Assigned:</label>
            <select id="unitAssigned" name="unitAssigned" required>
                <option value="">Select a property first</option>
            </select><br><br>

            <label for="lease_start">Lease Start Date:</label>
            <input type="date" id="lease_start" name="lease_start" required><br><br>

            <label for="deposit">Deposit Amount:</label>
            <input type="number" id="deposit" name="deposit" required><br><br>

            <label for="idProof">ID Proof (Image):</label>
            <input type="file" id="idProof" name="idProof" required><br><br>

            <label for="photo">Photo (Image):</label>
            <input type="file" id="photo" name="photo" required><br><br>

            <button type="submit">Submit</button>
        </form>
    </div>
</body>
</html>
